@model ChampionshipMvc3.Models.DataContext.Playfield
@using ChampionshipMvc3.Models.Repositories

    
<link href="../../Content/customBootstrap.css" rel="stylesheet" />
<link href="../../Content/Site.css" rel="stylesheet" />
<script src="@Url.Content("~/Scripts/CustomScripts/tableFillerScheduleLayout.js")" type="text/javascript"></script>
<script src="../../Scripts/CustomScripts/bootstrap.minPlayNow.js"></script>

<table id="structureTable">
    <tr>
        @{
            ReservationRepository reservationRepo = new ReservationRepository();
            var allReservations = reservationRepo.GetPlayfieldReservations(Model.PLayfieldID);
          
        }

        @for (int dayIndex = 0; dayIndex < 7; dayIndex++)
        {
           
            DateTime displayDate = DateTime.Now.AddDays(dayIndex);
            <td>
                <label>@displayDate.ToShortDateString()</label>
                <label>@displayDate.DayOfWeek</label>
                <table>
                    
                    @for (int hourIndex = Model.PlayfieldOwner.StartHour; hourIndex < Model.PlayfieldOwner.EndHour; hourIndex++)
                    {
                        bool isReserved = false;
                        <tr>
                            <td>
                                @{
                                    var compareDate = DateTime.Parse(displayDate.ToShortDateString() + " " + hourIndex.ToString() + ":00");
                                    if(allReservations.Any(r => r.ReservationDate.Equals(compareDate)))
                                    {
                                        isReserved = true; 
                                    }
                                }
                                <label>@isReserved</label>
                            </td>
                        </tr>
                    }
                </table>
            </td>
        }
    </tr>
</table>


<!-- Modal -->
<div class="modal fade" id="myModal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>
        <h4 class="modal-title" id="myModalLabel">Modal title</h4>
      </div>
      <div class="modal-body">
           
      </div>
      <div class="modal-footer">
        @Html.Partial("~/Views/Playfield/_ReservationModel.cshtml", new ChampionshipMvc3.Models.DataContext.Reservation())
        <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
        <button type="button" value="Reserve" class="btn btn-default reservationButton">Reserve</button>
      </div>
    </div>
  </div>
</div>


<script src="../../Scripts/CustomScripts/reservationJS.js"></script>
